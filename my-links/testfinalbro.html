<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Web of Laasya</title>
<script src="https://d3js.org/d3.v7.min.js"></script>

<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #111;
    font-family: "Roboto Mono", monospace;
  }
  .link {
    opacity: 0.85;
  }
  text {
    pointer-events: none;
  }
</style>
</head>

<body>
<script>
/* =========================
   COLOR MAP (AS REQUESTED)
========================= */
const colorMap = {
  "Love / Partner": "#931621",
  "Ex- Partners": "#033F63",
  "School friends": "#ff8080ff",
  "College Friends": "#FF8C42",
  "Family [immediate]": "#FF3C38",
  "distant family": "#FFF275",
  "girl - friends": "#EA638C",
  "friends of friends": "#CAE9FF",
  "hate": "#555555",
  "APT": "#6A0572",

  "prends": "#329160ff",
  "partners": "#FFB400",
  "familie": "#FF5C8D",
  "sship": "#c20000ff",
  "sfs": "#ff8080ff",
  "cfs": "#FF8C42",
  "bfs": "#ffff00ff",
  "cp": "#931621",
  "ex": "#67a3c8ff",
  "imf": "#FF3C38",
  "dif": "#FFF275",
  "cuzs": "#96dfc9ff",

  "dead": "#000000",
  "alive": "#EDEBA0",

  "girls": "#fe034fff",
  "boys": "#034ffe",
};

/* =========================
   DATA
========================= */
const nodes = [
  { id: "Me", status: "alive", kind: "me" },

  // categories (fixed)
  { id: "Friends", status: "prends", kind: "category" },
  { id: "Family", status: "familie", kind: "category" },
  { id: "Partners", status: "partners", kind: "category" },

  // people
  { id: "Vasist", status: "alive", kind: "person" },
  { id: "Raghav", status: "alive", kind: "person" },
  { id: "Tejas", status: "alive", kind: "person" },
  { id: "Mahima", status: "alive", kind: "person" },
  { id: "Harshad", status: "dead", kind: "person" }
];

const links = [
  // people -> me
  { source: "Vasist", target: "Me", type: "imf" },
  { source: "Raghav", target: "Me", type: "sship" },
  { source: "Tejas", target: "Me", type: "cp" },
  { source: "Mahima", target: "Me", type: "sfs" },
  { source: "Harshad", target: "Me", type: "ex" },

  // me -> categories
  { source: "Me", target: "Friends", type: "prends" },
  { source: "Me", target: "Family", type: "familie" },
  { source: "Me", target: "Partners", type: "partners" }
];

/* =========================
   SVG SETUP
========================= */
const width = window.innerWidth;
const height = window.innerHeight;

const svg = d3.select("body")
  .append("svg")
  .attr("width", width)
  .attr("height", height);

const g = svg.append("g");

/* =========================
   FORCE SIMULATION
========================= */
const simulation = d3.forceSimulation(nodes)
  .force("link", d3.forceLink(links)
    .id(d => d.id)
    .distance(d => d.source.id === "Me" ? 140 : 90)
    .strength(1)
  )
  .force("charge", d3.forceManyBody()
    .strength(d => d.kind === "category" ? -40 : -400)
  )
  .force("collision", d3.forceCollide(40))
  .force("center", d3.forceCenter(width / 2, height / 2));

/* =========================
   PIN CATEGORIES (RIGHT SIDE)
========================= */
nodes.forEach((d, i) => {
  if (d.kind === "category") {
    d.fx = width - 160;
    d.fy = 150 + i * 90;
  }
  if (d.id === "Me") {
    d.fx = width / 2;
    d.fy = height / 2;
  }
});

/* =========================
   LINKS
========================= */
const link = g.selectAll(".link")
  .data(links)
  .enter()
  .append("line")
  .attr("class", "link")
  .attr("stroke", d => colorMap[d.type] || "#888")
  .attr("stroke-width", d => d.source.id === "Me" || d.target.id === "Me" ? 3 : 1.5);

/* =========================
   NODES
========================= */
const node = g.selectAll(".node")
  .data(nodes)
  .enter()
  .append("g")
  .call(d3.drag()
    .on("start", dragstarted)
    .on("drag", dragged)
    .on("end", dragended)
  );

node.append("rect")
  .attr("x", -6)
  .attr("y", -12)
  .attr("rx", 4)
  .attr("ry", 4)
  .attr("width", d => d.id.length * 8 + 10)
  .attr("height", 22)
  .attr("fill", d => colorMap[d.status] || "#999");

node.append("text")
  .text(d => d.id)
  .attr("y", 4)
  .attr("fill", d => d.status === "dead" ? "#fff" : "#000")
  .attr("font-size", 12);

/* =========================
   TICK
========================= */
simulation.on("tick", () => {
  link
    .attr("x1", d => d.source.x)
    .attr("y1", d => d.source.y)
    .attr("x2", d => d.target.x)
    .attr("y2", d => d.target.y);

  node.attr("transform", d => `translate(${d.x},${d.y})`);
});

/* =========================
   DRAG FUNCTIONS
========================= */
function dragstarted(event, d) {
  if (!event.active) simulation.alphaTarget(0.3).restart();
  d.fx = d.x;
  d.fy = d.y;
}

function dragged(event, d) {
  d.fx = event.x;
  d.fy = event.y;
}

function dragended(event, d) {
  if (!event.active) simulation.alphaTarget(0);
  if (d.kind !== "category" && d.id !== "Me") {
    d.fx = null;
    d.fy = null;
  }
}

/* =========================
   ZOOM
========================= */
svg.call(
  d3.zoom()
    .scaleExtent([0.3, 3])
    .on("zoom", e => g.attr("transform", e.transform))
);
</script>
</body>
</html>
